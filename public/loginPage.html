<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Reciept Manager</title>
    <link rel="stylesheet" href="main.css">
    <link rel="icon" href="Receipt-Icon.png">

    <meta name="google-signin-scope" content="profile email">
    <meta name="google-signin-client_id" content="1030385101120-oud1pj9gnqed70prr548rslnr4j8a4us.apps.googleusercontent.com">
    <script src="https://apis.google.com/js/platform.js" async defer></script> 

  </head>
  <body>
        <header>
            <a class = "logo" href="https://receipthelpmanage.herokuapp.com"><img class = "MainImage" src="Receipt-Icon.png" alt = "logo"></a>
            <nav>
                <ul class="topbar">
                    
                </ul>
            </nav>
        </header>

        <main>
          <div class="ContentContainer">
            <div class="TitleContent"> Manage Receipts, Simply</div>
            <div class = LoginContainer>
              <div class="Title">
                Login with Google
              </div>
                <div class="GoogleContainer">
                  <div class="g-signin2" data-onsuccess="onSignIn" data-onfail="OnFail" data-theme="dark" data-width="200%">Sign in with Google</div>
                  <script>
                    function onSignIn(googleUser) {
                      // Useful data for your client-side scripts:
                      var profile = googleUser.getBasicProfile();
                      console.log("ID: " + profile.getId()); // Don't send this directly to your server!
                      console.log('Full Name: ' + profile.getName());
                      console.log('Given Name: ' + profile.getGivenName());
                      console.log('Family Name: ' + profile.getFamilyName());
                      console.log("Image URL: " + profile.getImageUrl());
                      console.log("Email: " + profile.getEmail());

                      // The ID token you need to pass to your backend:
                      var id_token = googleUser.getAuthResponse().id_token;
                      console.log("ID Token: " + id_token);

                      var xhr = new XMLHttpRequest();
                      xhr.open('POST', '/login');
                      xhr.setRequestHeader('Content-Type', 'application/json');
                      xhr.onload = function() {
                        console.log('Signed in as: ' + xhr.responseText);
                        if(xhr.responseText == 'success'){
                            signOut();
                            location.assign('/profile')
                        }
                      };
                      xhr.send(JSON.stringify({token: id_token}));
                    }

                    function OnFail(data) {
                      console.log(data);
                    }   

                  </script>

              
                  <script>
                    function signOut() {
                      var auth2 = gapi.auth2.getAuthInstance();
                      auth2.signOut().then(function () {
                        console.log('User signed out.');
                      });
                    }
                  </script>


                </div>

            </div>

            <a href="#ProductDetails" class="HowItWorks"> How it Works <br><i class="arrow down"></i></a>
          </div>

          <div id="ProductDetails">

            <div class="Step"> 
              <div class ="DecorativeLine"></div>
              <img class = "DecorImage" src="Google-Logo.png" alt = "DecorImage">
              <div class="StepTitle">Login with Google</div> 
              <div class="StepContent">
                Use any Google account to login to the service. Your Google account will be used to authenticate your account and load the valid content.
              </div>
            </div>

            <div class="Step"> 
              <div class ="DecorativeLine"></div>
              <img class = "DecorImage" src="Receipt.png" alt = "DecorImage">
              <div class="StepTitle">Add Reciepts</div> 
              <div class="StepContent">
                Add any amount of receipts, providing a date, place, method of payment(optional), and amount. Your reciepts will then be saved and sorted.
              </div>
            </div>

            <div class="Step"> 
              <div class ="DecorativeLine"></div>
              <img class = "DecorImage" src="hammer.png" alt = "DecorImage">
              <div class="StepTitle">Use Available Tools</div> 
              <div class="StepContent">
                Use the tools available to sort, track, and list your reciepts.
              </div>
            </div>


          </div>
        </main>

  </body>

</html>